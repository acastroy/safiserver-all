<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- WARNING: Eclipse auto-generated file.
              Any modifications will be overwritten.
              To include a user specific buildfile here, simply create one in the same
              directory with the processing instruction <?eclipse.ant.import?>
              as the first entry and export the buildfile again. -->
<project basedir="." default="build" name="AsteriskSafletDesigner.diagram">
  <property environment="env"/>
  <property name="ECLIPSE_HOME" value="../../galileo/eclipse"/>
  <property name="debuglevel" value="source,lines,vars"/>
  <property name="target" value="1.6"/>
  <property name="source" value="1.6"/>
  <property name="safi_install_dir" value="c:/safi_install" />
  <path id="Plug-in Dependencies.libraryclasspath">
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.ide_3.5.0.I20090525-2000.jar"/>
      <pathelement location="../../Saflets"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.ecore_2.5.0.v200906151043.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.common_2.5.0.v200906151043.jar"/>
      <pathelement location="../../Saflets.edit"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.edit_2.5.0.v200906151043.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.ecore.change_2.5.0.v200906151043.jar"/>
      <pathelement location="../../SafiDB"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.teneo.hibernate_1.1.0.v200906180911.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.teneo_1.1.0.v200906180911.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.teneo.annotations_1.1.0.v200906180911.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.teneo.hibernate.mapper_1.1.0.v200906180911.jar"/>
      <pathelement location="../../SafiDB.edit"/>
      <pathelement location="../../SafiCommons"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.runtime_3.5.0.v20090525.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.osgi_3.5.0.v20090520.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/javax.transaction_1.1.1.v200906161300.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.persistence.jpa.equinox.weaving_1.1.2.v20090612-r4475.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.equinox.common_3.5.0.v20090520-1800.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.jobs_3.4.100.v20090429-1800.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.runtime.compatibility.registry_3.2.200.v20090429-1800/runtime_registry_compatibility.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.equinox.registry_3.4.100.v20090520-1800.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.equinox.preferences_3.2.300.v20090520-1800.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.contenttype_3.4.0.v20090429-1800.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.equinox.app_1.2.0.v20090520-1800.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jface_3.5.0.I20090525-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.swt_3.5.0.v3550b.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.swt.win32.win32.x86_3.5.0.v3550b.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.commands_3.5.0.I20090525-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.views_3.4.0.I20090525-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.ecore.xmi_2.5.0.v200906151043.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.edit.ui_2.5.0.v200906151043.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.workbench_3.5.0.I20090603-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.common.ui_2.5.0.v200906151043.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui_3.5.0.I20090604-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.emf.core_1.2.0.v20090422-1925.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.common.core_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.resources_3.5.0.v20090512.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.workspace_1.3.0.v200902100422.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.transaction_1.3.0.v200902010221.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.emf.validation_1.3.0.v200901271722.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.emf.clipboard.core_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.emf.commands.core_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.emf.ui.properties_1.2.0.v20090501-1750.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.common.ui.services.properties_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.common.ui_1.2.0.v20090526-1925.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.console_3.4.0.v20090513.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jface.text_3.5.0.v20090602.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.text_3.5.0.v20090513-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.workbench.texteditor_3.5.0.v20090603.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.team.core_3.5.0.I20090527-0620.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.diagram.ui_1.2.0.v20090526-1925.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gef_3.5.0.v20090528-1511.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.draw2d_3.5.0.v20090528-1511.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.emf.ui_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.common.ui.action_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.common.ui.services.action_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.common.ui.services_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.emf.type.core_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.gef.ui_1.2.0.v20090520-1343.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.draw2d.ui_1.2.0.v20090526-1925.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.views.properties.tabbed_3.5.0.I20090429-1800.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.forms_3.4.0.v20090526.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.notation_1.2.0.v20090521-1925.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.diagram.core_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.diagram.ui.properties_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.diagram.ui.providers_1.2.0.v20090526-1925.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.diagram.ui.render_1.2.0.v20090520-1343.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.diagram.ui.resources.editor_1.2.0.v20090526-1925.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ocl.ecore_1.3.0.v200905271400.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ocl_1.3.0.v200905271400.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/net.sourceforge.lpg.lpgjavaruntime_1.1.0.v200803061910.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.draw2d.ui.render_1.2.0.v20090526-1925.jar"/>
      <pathelement location="../../com.safi.asterisk.figures"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.editors_3.5.0.v20090527-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.filebuffers_3.5.0.v20090526-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.navigator_3.4.0.I20090525-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.navigator.resources_3.4.0.I20090525-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.expressions_3.4.100.v20090429-1800.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.diagram.ui.printing_1.2.0.v20090526-1925.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.gmf.runtime.diagram.ui.printing.render_1.2.0.v20090403-1720.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.update.core_3.2.300.v20090525.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.update.scheduler_3.2.200.v20081127.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.update.ui_3.2.200.v20090213.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.filesystem_1.2.0.v20090507.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.intro_3.3.0.v20090526.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.help_3.4.0.v20090526.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.ui.cheatsheets_3.3.200.v20090526.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.apache.commons.lang_2.4.0.v20081016-1030.jar"/>
      <pathelement location="../../Hibernate30"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.apache.commons.logging_1.0.4.v200904062259.jar"/>
      <pathelement location="../../org.jdom"/>
      <pathelement location="../../org.eclipse.dltk.console"/>
      <pathelement location="../../org.eclipse.dltk.console.ui"/>
      <pathelement location="../../org.eclipse.dltk.core"/>
      <pathelement location="../../org.eclipse.dltk.debug"/>
      <pathelement location="../../org.eclipse.dltk.debug.ui"/>
      <pathelement location="../../org.eclipse.dltk.formatter"/>
      <pathelement location="../../org.eclipse.dltk.javascript.core"/>
      <pathelement location="../../org.eclipse.dltk.javascript.core.dom.support"/>
      <pathelement location="../../org.eclipse.dltk.javascript.debug"/>
      <pathelement location="../../org.eclipse.dltk.javascript.debug.ui"/>
      <pathelement location="../../org.eclipse.dltk.javascript.jdt.integration"/>
      <pathelement location="../../org.eclipse.dltk.javascript.jsjdtdebugger"/>
      <pathelement location="../../org.eclipse.dltk.javascript.launching"/>
      <pathelement location="../../org.eclipse.dltk.javascript.rhino"/>
      <pathelement location="../../org.eclipse.dltk.javascript.rhino.dbgp"/>
      <pathelement location="../../org.eclipse.dltk.javascript.ui"/>
      <pathelement location="../../org.eclipse.dltk.launching"/>
      <pathelement location="../../org.eclipse.dltk.ui"/>
      <pathelement location="../../org.eclipse.dltk.validators.core"/>
      <pathelement location="../../org.eclipse.dltk.validators.externalchecker"/>
      <pathelement location="../../org.eclipse.dltk.validators.ui"/>
      <pathelement location="../../org.eclipse.emf.databinding"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.databinding_1.2.0.I20090604-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.databinding.observable_1.2.0.I20090604-2000.jar"/>
      <pathelement location="../../org.eclipse.emf.databinding.edit"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.core.databinding.beans_1.2.0.I20090525-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jface.databinding_1.3.0.I20090525-2000.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.debug.core_3.5.0.v20090526-1600.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.debug.ui_3.5.0.v20090603.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.core_3.5.0.v_963.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.compiler.apt_1.0.200.v20090528-1135.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.compiler.tool_1.0.100.v_963.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.debug_3.5.0.v20090526/jdi.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.debug_3.5.0.v20090526/jdimodel.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.launching_3.5.0.v20090527.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.ui_3.5.0.v20090604.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.debug.ui_3.4.0.v20090527.jar"/>
      <pathelement location="${ECLIPSE_HOME}/plugins/org.eclipse.jdt.core.manipulation_1.3.0.v20090603.jar"/>
      <pathelement location="../../AsteriskCore"/>
      <pathelement location="../../AsteriskCore.edit"/>
      <pathelement location="../../AsteriskSafiServerPlugin"/>
  </path>
  <path id="AsteriskSafletDesigner.diagram.classpath">
      <pathelement location="lib/licensews.jar"/>
      <pathelement location="lib/layout.jar"/>
      <pathelement location="lib/truezip-6.jar"/>
      <path refid="Plug-in Dependencies.libraryclasspath"/>
      <pathelement location="bin"/>
      <pathelement location="lib/safiRouting.jar"/>
      <pathelement location="lib/nanoxml.jar"/>
      <pathelement location="lib/rowset.jar"/>
      <pathelement location="lib/squirrel.jar"/>
      <pathelement location="lib/dom4j-1.6.1.jar"/>
      <pathelement location="lib/jmf.jar"/>
      <pathelement location="lib/com.richclientgui.toolbox.0.4.jar"/>
      <pathelement location="lib/javalayer.jar"/>
      <pathelement location="lib/tritonus_gsm-0.3.6.jar"/>
      <pathelement location="lib/tritonus_mp3-0.3.6.jar"/>
      <pathelement location="lib/tritonus_remaining-0.3.6.jar"/>
      <pathelement location="lib/tritonus_share-0.3.6.jar"/>
      <pathelement location="lib/nebula_compositetable.jar"/>
      <pathelement location="lib/nebula_cdatetime_0.9.0.jar"/>
      <pathelement location="lib/tritonus_dsp-0.3.6.jar"/>
      <pathelement location="lib/args4j-2.0.1.jar"/>
      <pathelement location="lib/customInitiator.jar"/>
      <pathelement location="lib/customInitiatorInvoker.jar"/>
      <pathelement location="lib/boolExprParser.jar"/>
  </path>
	<target name="init">
		<mkdir dir="bin" />
		<copy includeemptydirs="false" todir="bin">
			<fileset dir="src" excludes="**/*.launch, **/*.java" />
		</copy>
	</target>
	<target name="clean">
		<delete dir="bin" />
	</target>
	<target depends="clean" name="cleanall" />
	<target depends="build-subprojects,build-project" name="build" />
	<target name="build-subprojects" />
	<target depends="init" name="build-project">
		<echo message="${ant.project.name}: ${ant.file}" />
		<javac debug="true" debuglevel="${debuglevel}" destdir="bin" source="${source}" target="${target}">
			<src path="src" />
			<classpath refid="AsteriskSafletDesigner.diagram.classpath" />
		</javac>
	</target>
	<target description="Build all projects which reference this project. Useful to propagate changes." name="build-refprojects" />
	<target description="copy Eclipse compiler jars to ant lib directory" name="init-eclipse-compiler">
		<copy todir="${ant.library.dir}">
			<fileset dir="${ECLIPSE_HOME}/plugins" includes="org.eclipse.jdt.core_*.jar" />
		</copy>
		<unzip dest="${ant.library.dir}">
			<patternset includes="jdtCompilerAdapter.jar" />
			<fileset dir="${ECLIPSE_HOME}/plugins" includes="org.eclipse.jdt.core_*.jar" />
		</unzip>
	</target>
	<target description="compile project with Eclipse compiler" name="build-eclipse-compiler">
		<property name="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter" />
		<antcall target="build" />
	</target>

	<target name="full_build">
		<ant antfile="../RectilinearRouting/big_build.xml" target="build" />
		<ant antfile="../Handlers/big_build.xml" target="build" />
	</target>

	<target name="obfuscate" depends="build">
		<taskdef resource="proguard/ant/task.properties" classpath="proguard/proguard.jar" />

		<echo message="Obfuscating RectilinearRouting" />
		<proguard configuration="../RectilinearRouting/Routing.pro" />

		<echo message="Obfuscating SafiServerCore" />
		<proguard configuration="../SafiServerCore/safiServer.pro" />

		<echo message="Copying SafiServerCore to safiServer_v20090712.jar" />
		<proguard configuration="../SafiServerCore/safiServerExport.pro" />
		<copy tofile="../AsteriskSafiServerPlugin/lib/safiServer.jar" overwrite="true">
			<fileset file="../AsteriskSafiServerPlugin/safiServer.jar" />
		</copy>
		<delete file="../AsteriskSafiServerPlugin/safiServer.jar" />
		<!--
		<copy tofile="../AsteriskSafiServerPlugin/lib/safiServer.jar" overwrite="true">
			<fileset  file="../SafiServerCore/obfuscated/safiServer_v20090712.jar">
			</fileset>
		</copy>
		-->
		<!-- <move file="../SafiServerPlugin/lib/safiServer_v20090219.jar" tofile="../SafiServerPlugin/lib/safiServer.jar" overwrite="true" /> -->
		<ant dir="../SafiDB" antfile="../SafiDB/build_enhanced.xml" target="instrument" />

		<delete includeEmptyDirs="true">
			<fileset dir="D:\temp\safiStaging\non_obfuscated" includes="**/*" />
		</delete>

	</target>

	<target name="obfuscate2" depends="build">
		<taskdef resource="proguard/ant/task.properties" classpath="proguard/proguard.jar" />

		<echo message="Cleaning old obfuscated build" />
		<delete includeEmptyDirs="true">
			<fileset dir="D:\temp\safiStaging\obfuscated" includes="**/*" />
		</delete>

		<echo message="Copying to obfuscated build dir" />
		<copy todir="D:\temp\safiStaging\obfuscated\eclipse" overwrite="true">
			<fileset dir="D:\temp\safiStaging\non_obfuscated\eclipse">
				<include name="**/*" />
				<exclude name="**/AsteriskSafletDesigner.diagram*.jar/**" />
			</fileset>
		</copy>

		<!-- <proguard configuration="../SafJSEditor-1.0/jseditor.pro" /> -->

		<echo message="Obfuscating Saflets" />
		<proguard configuration="../Saflets/Saflets.pro" />
		<echo message="Obfuscating SafiServer" />
		<proguard configuration="../AsteriskSafiServerPlugin/safiserver.pro" />
		<echo message="Obfuscating AsteriskSafletDesigner.diagram" />
		<proguard configuration="Diagram.pro" />
		<echo message="Obfuscating CoreActionPak1" />
		<proguard configuration="../CoreActionPak1/actionpak1.pro" />
		<echo message="Obfuscating TimeBasedRoutingNew ActionPak" />
		<proguard configuration="../TimeBasedRoutingPakNew/timebasedrouting.pro" />


		<echo message="Cleaning staging dir" />
		<delete verbose="true" quiet="true" includeemptydirs="true">
			<fileset file="D:\safi_install\SafiWorkshop\SafiWorkshop.*" />
			<fileset file="D:\safi_install\SafiWorkshop\.eclipseproduct" />
			<fileset dir="D:\safi_install\SafiWorkshop\plugins" />
			<fileset dir="D:\safi_install\SafiWorkshop\features" />
			<fileset dir="D:\safi_install\SafiWorkshop\configuration" />
		</delete>

		<echo message="copying to staging dir" />
		<copy todir="D:\safi_install\SafiWorkshop" overwrite="true">
			<fileset dir="D:\temp\safiStaging\obfuscated\eclipse">
				<include name="**/*" />
			</fileset>
		</copy>
		<!--
		 <taskdef name="nsis" classname="net.sf.nsisant.Task">
		        <classpath location="proguard/nsisant-1.2.jar"/>
		  </taskdef>
		<nsis script="../SAFIInstaller/build_workshop.nsi"/>
-->
	</target>

	<target name="obfuscateServer" depends="build">
		<echo message="Obfuscating server..." />
		<taskdef resource="proguard/ant/task.properties" classpath="proguard/proguard.jar" />

		<echo message="Doin up handlersLib.pro" />
		<proguard configuration="../Saflets/SafletsLib.pro" />
		<copy todir="../SafiServerCore/lib" overwrite="true">
			<fileset file="../Saflets/obfuscated/safletcore*.jar">
			</fileset>
		</copy>

		<echo message="Rebuilding SafiDB" />
		<ant dir="../SafiDB" antfile="../SafiDB/build_enhanced.xml" target="cleanall" />
		<ant dir="../SafiDB" antfile="../SafiDB/build_enhanced.xml" target="build" />
		<echo message="Obfuscating SafiDB" />
		<proguard configuration="../SafiDB/SafiDBRuntime.pro" />

		<echo message="Obfuscating SafiServer.." />
		<proguard configuration="../SafiServerCore/safiServer.pro" />

		<copy todir="../SafiServerCore/lib" overwrite="true">
			<fileset file="../SafiServerCore/obfuscated/safiServer*.jar">
			</fileset>
		</copy>

		<echo message="deleting DB if it exists" />
		<delete includeEmptyDirs="true" failonerror="false">
			<fileset dir="../SafiServerCore/db" includes="**/*" />
		</delete>
		<!--
		<taskdef name="nsis" classname="net.sf.nsisant.Task">
		            <classpath location="proguard/nsisant-1.2.jar"/>
		      </taskdef>
		 <nsis script="../SafiServerInstaller/SafiServerInstall2.nsi"/>
-->
	</target>

	<target name="linuxDeploy">
		<delete file="../SafiServerInstaller/safiServerLinux32.zip" quiet="true" />

		<delete dir="${safi_install_dir}/serverLinux32" includeemptydirs="false" quiet="false" />

		<copy todir="${safi_install_dir}/serverLinux32/SafiServer" includeemptydirs="true" overwrite="true">
			<fileset dir="../SafiServerCore/" defaultexcludes="true">
				<include name="default_drivers/**" />
				<include name="lib/**" />
				<include name="logs/**" />
				<include name="deploy/actionpaks/**" />
				<include name="resources/**" />
				<include name="deploy/lib/**" />
				<include name="deploy/linux32/**" />
				<include name="deploy/libs.conf" />
				<exclude name="deploy/linux32/jre.zip" />
				<exclude name="**/*.bak" />
				<exclude name="**/*.log" />
				<exclude name="**/*.log.*" />
				<exclude name="**/*.keepme" />
			</fileset>
		</copy>
		<mkdir dir="${safi_install_dir}/serverLinux32/SafiServer/deploy/actionpaks" />
		<mkdir dir="${safi_install_dir}/serverLinux32/SafiServer/imports/received" />

		<move file="${safi_install_dir}/serverLinux32/SafiServer/deploy/linux32/installserver.sh" todir="${safi_install_dir}/serverLinux32/SafiServer">
		</move>
		<tar compression="gzip" basedir="D:\safi_install\serverLinux32" destfile="../SafiServerInstaller/safiServerLinux32.tar.gz" />

	</target>

</project>
